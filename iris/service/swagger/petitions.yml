definitions:
    PublicState:
        type: object
        properties:
            state:
                type: object
                readOnly: true
                properties:
                    name:
                        type: string
                        readOnly: true
                        default: 'draft'
                    parent:
                        type: string
                        readOnly: true
                        default: ''
    PrivateState:
        type: object
        properties:
            state:
                type: object
                readOnly: true
                properties:
                    name:
                        type: string
                        readOnly: true
                        default: 'draft'
                    parent:
                        type: string
                        readOnly: true
                        default: ''
                    listable:
                        type: boolean
                        readOnly: true
                    timer:
                        type: integer
                        readOnly: true
                        default: 0

    ReadOnly:
        type: object
        properties:
            id:
                type: string
                readOnly: true
            dc:
                type: object
                readOnly: true
                properties:
                    created:
                        type: string
                        format: dateTime
                        description: ISO8601
                    modified:
                        type: string
                        format: dateTime
                        description: ISO8601
                    effective:
                        type: string
                        x-nullable: true
                        format: dateTime
                        description: visible after this time (ISO8601)
                    expires:
                        type: string
                        x-nullable: true
                        format: dateTime
                        description: visible until this time (ISO8601)

    Properties:
        type: object
        properties:
            tags:
                type: array
                items:
                    type: string
            title:
                type: string
                default: ''
            description:
                type: string
                default: ''
            city:
                type: object
                properties:
                    id:
                        type: string
                        x-nullable: true
                    class:
                        type: string
                    data:
                        $ref: 'cities.yml#/definitions/City'
                        x-nullable: true
            city_answer:
                type: string
                default: ''
            type:
                type: string
                default: ''
            suggested_solution:
                type: string
            images:
                type: array
                items:
                    type: object
                    properties:
                        id:
                            type: string
                            x-nullable: true
                        class:
                            type: string
                            readOnly: true
                        data:
                            $ref: 'files.yml#/definitions/File'
                        state:
                            type: string
                            enum:
                                - visible
                                - hidden
            supporters:
                type: object
                readOnly: true
                properties:
                    amount:
                        type: integer
                        readOnly: true
                    required:
                        type: integer
                        readOnly: true
            response_token:
                type: string
                x-nullable: true
                readOnly: true

    ReadProperties:
        type: object
        properties:
            links:
                type: array
                items:
                    type: object
                    properties:
                        id:
                            type: string
                            x-nullable: true
                        url:
                            type: string
                            x-nullable: true
                        class:
                            type: string
                            readOnly: true
                        data:
                            $ref: 'weblocations.yml#/definitions/WebLocationReadOnly'
                        state:
                            type: string
                            enum:
                                - visible
                                - hidden
            mentions:
                type: array
                items:
                    type: object
                    properties:
                        id:
                            type: string
                            x-nullable: true
                        url:
                            type: string
                            x-nullable: true
                        class:
                            type: string
                            readOnly: true
                        data:
                            $ref: 'weblocations.yml#/definitions/WebLocationReadOnly'
                        state:
                            type: string
                            enum:
                                - visible
                                - hidden

    WriteProperties:
        type: object
        properties:
            links:
                type: array
                items:
                    type: object
                    properties:
                        id:
                            type: string
                            x-nullable: true
                        url:
                            type: string
                            x-nullable: true
                        state:
                            type: string
                            enum:
                                - visible
                                - hidden
            mentions:
                type: array
                items:
                    type: object
                    properties:
                        id:
                            type: string
                            x-nullable: true
                        url:
                            type: string
                            x-nullable: true
                        state:
                            type: string
                            enum:
                                - visible
                                - hidden

    PropertiesForPublic:
        type: object
        properties:
            owner:
                type: object
                readOnly: true
                properties:
                    id:
                        type: string
                        x-nullable: true
                    class:
                        type: string
                        readOnly: true
                    data:
                        $ref: 'users.yml#/definitions/UserPublic'

    PropertiesForAdmin:
        type: object
        properties:
            owner:
                type: object
                properties:
                    id:
                        type: string
                        x-nullable: true
                    class:
                        type: string
                    data:
                        $ref: 'users.yml#/definitions/UserAdmin'

    Petition:
        type: object
        allOf:
            - $ref: '#/definitions/ReadOnly'
            - $ref: '#/definitions/PublicState'
            - $ref: '#/definitions/Properties'
            - $ref: '#/definitions/ReadProperties'
            - $ref: '#/definitions/PropertiesForPublic'

    PetitionWrite:
        type: object
        allOf:
            - $ref: '#/definitions/ReadOnly'
            - $ref: '#/definitions/PublicState'
            - $ref: '#/definitions/Properties'
            - $ref: '#/definitions/WriteProperties'
            - $ref: '#/definitions/PropertiesForPublic'

    AdminPetition:
        type: object
        allOf:
            - $ref: '#/definitions/ReadOnly'
            - $ref: '#/definitions/PrivateState'
            - $ref: '#/definitions/Properties'
            - $ref: '#/definitions/ReadProperties'
            - $ref: '#/definitions/PropertiesForAdmin'

    AdminPetitionWrite:
        type: object
        allOf:
            - $ref: '#/definitions/ReadOnly'
            - $ref: '#/definitions/PrivateState'
            - $ref: '#/definitions/Properties'
            - $ref: '#/definitions/ReadProperties'
            - $ref: '#/definitions/PropertiesForAdmin'

    POSTBody:
        # The petition wrapped in a data property for the POST bodies
        type: object
        required: 
            - data
        properties:
            data:
                $ref: '#/definitions/PetitionWrite'
    ResponseBody:
        # The petition wrapped in a data property for the response body
        type: object
        required: 
            - data
        properties:
            data:
                $ref: '#/definitions/Petition'
    ListResponseBody:
        description: Petition list response
        type: object
        required: 
            - data
            - total
        properties:
            data:
                type: array
                items:
                    $ref: '#/definitions/Petition'
            total:
                type: integer
    POSTBodyAdmin:
        # The petition wrapped in a data property for the POST bodies
        type: object
        required: 
            - data
        properties:
            data:
                $ref: '#/definitions/AdminPetitionWrite'
    ResponseBodyAdmin:
        # The petition wrapped in a data property for the response body
        type: object
        required: 
            - data
        properties:
            data:
                $ref: '#/definitions/AdminPetition'
    ListResponseBodyAdmin:
        description: Petition list response
        type: object
        required: 
            - data
            - total
        properties:
            data:
                type: array
                items:
                    $ref: '#/definitions/AdminPetition'
            total:
                type: integer
